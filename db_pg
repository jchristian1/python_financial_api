DROP TABLE IF EXISTS public."Financial_Statement_type" CASCADE;
CREATE TABLE public."Financial_Statement_type"(
	id_Financial_Statement_type INT GENERATED ALWAYS AS IDENTITY,
	name_financial VARCHAR(50),
	PRIMARY KEY(id_Financial_Statement_type)
	);
	
DROP TABLE IF EXISTS public."Financial_Indicator" CASCADE;
CREATE TABLE public."Financial_Indicator"(
	id_Financial_Indicator INT GENERATED ALWAYS AS IDENTITY,
	description VARCHAR(500),
	indicator_name VARCHAR(50),
	tag VARCHAR(100),
	PRIMARY KEY(id_Financial_Indicator)
	);

DROP TABLE IF EXISTS public."Company" CASCADE;
CREATE TABLE public."Company"(
	id_company INT GENERATED ALWAYS AS IDENTITY,
	name_company VARCHAR(50),
	symbol VARCHAR(10) UNIQUE,
	cik VARCHAR(10),
	sector VARCHAR(50),
	industry_category VARCHAR(50),
	industry_group VARCHAR(50),
	company_url VARCHAR(100),
	description VARCHAR(2000),
	sic VARCHAR(4),	
	employees integer,
	PRIMARY KEY(id_company)
	);

DROP TABLE IF EXISTS public."Financial_Statement_Fact" CASCADE;
CREATE TABLE public."Financial_Statement_Fact"(
	id_financial_statement_fact INT GENERATED ALWAYS AS IDENTITY,
	id_company INT,
	id_Financial_Indicator INT,
	fiscal_year INT,
	fiscal_period VARCHAR(50),
	filling_date DATE,
	start_date DATE,
	end_date DATE,
	url VARCHAR(150),
	urlfinal VARCHAR(150),
	unit VARCHAR(10),
	ammount DOUBLE PRECISION,	
	PRIMARY KEY(id_financial_statement_fact),
	CONSTRAINT fk_company
		FOREIGN KEY(id_company)
			REFERENCES public."Company"(id_company),
	CONSTRAINT fk_financial_indicator
		FOREIGN KEY(id_Financial_Indicator)
			REFERENCES public."Financial_Indicator"(id_Financial_Indicator)	
	);
	
DROP TABLE IF EXISTS public."Financial_Statement_Indicator_sequence" CASCADE;
CREATE TABLE public."Financial_Statement_Indicator_sequence"(
	id_Financial_Statement_Indicator_sequence INT GENERATED ALWAYS AS IDENTITY,
	id_Financial_Statement_type INT,
	id_Financial_Indicator INT,
	sequencia INT,	
	PRIMARY KEY(id_Financial_Statement_Indicator_sequence),
	CONSTRAINT fk_financial_statement_type
		FOREIGN KEY(id_Financial_Statement_type)
			REFERENCES public."Financial_Statement_type"(id_Financial_Statement_type),
	CONSTRAINT fk_financial_indicator
		FOREIGN KEY(id_Financial_Indicator)
			REFERENCES public."Financial_Indicator"(id_Financial_Indicator)	
	);
	
INSERT INTO PUBLIC."Financial_Indicator"(description,indicator_name,tag)
	VALUES
	('Revenue is the total amount of income generated by the sale of goods or services related to the companys primary operations. Revenue, also known as gross sales, is often referred to as the top line because it sits at the top of the income statement.',
	 'Revenue',
	 'revenue'),
	('What Is Cost of Revenue? The term cost of revenue refers to the total cost of manufacturing and delivering a product or service to consumers. Cost of revenue information is found in a companys income statement. It is designed to represent the direct costs associated with the goods and services the company provides.',
	 'Cost of Revenue',
	 'costOfRevenue'),
	('Gross profit, also called gross income, is calculated by subtracting the cost of goods sold from revenue.',
	 'Gross Profit',
	 'grossProfit'),
	('Gross profit ratio (GP ratio) is a financial ratio that measures the performance and efficiency of a business by dividing its gross profit figure by the total net sales.',
	 'Gross Profit Ratio',
	 'grossProfitRatio'),
	('Research and development (R&D) expenses are direct expenditures relating to a companys efforts to develop, design, and enhance its products, services, technologies, or processes. The industrial, technological, health care, and pharmaceutical sectors typically incur the highest degree of R&D expenses.',
	 'Research and Development Expenses',
	 'researchAndDevelopmentExpenses'),
	('General and Administrative (G&A) expenses are the day-to-day costs a business must pay to operate, whether or not it manufactures products or generates revenue. Typical G&A expenses include rent, utilities, insurance payments, and wages and salaries for administrative and management staff other than salespeople.',
	 'Geneal and Administrative Expenses',
	 'generalAndAdministrativeExpenses'),
	('Selling expenses can include: Distribution costs such as logistics, shipping and insurance costs. Marketing costs such as advertising, website maintenance and spending on social media. Selling costs such as wages, commissions and out-of-pocket expenses.',
	 'Selling and Marketing Expenses',
	 'sellingAndMarketingExpenses'),
	('Selling, General & Administrative expenses (SG&A) include all everyday operating expenses of running a business that are not included in the production of goods or delivery of services. Typical SG&A items include rent, salaries, advertising and marketing expenses and distribution costs.',
	 'Selling General and Administrative Expenses',
	 'sellingGeneralAndAdministrativeExpenses'),
	('Other expenses are expenses that do not relate to a companys main business. As well as operating costs, the company needs to consider other expenses including interest expense and losses from disposing of fixed assets.',
	 'Other Expenses',
	 'otherExpenses'),
	('An operating expense is an expense a business incurs through its normal business operations. Often abbreviated as OPEX, operating expenses include rent, equipment, inventory costs, marketing, payroll, insurance, step costs, and funds allocated for research and development.',
	 'Operating Expenses',
	 'operatingExpenses'),
	('',
	 'Cost and Expenses',
	 'costAndExpenses'),
	('Interest income is the amount paid to an entity for lending its money or letting another entity use its funds. On a larger scale, interest income is the amount earned by an investor’s money that he places in an investment or project. A very simple and basic way of computing it is by multiplying the principal amount by the interest rate applied, considering the number of months or years the money is lent.',
	 'Interest Income',
	 'interestIncome'),
	('An interest expense is the cost incurred by an entity for borrowed funds. Interest expense is a non-operating expense shown on the income statement. It represents interest payable on any borrowings—bonds, loans, convertible debt or lines of credit.',
	 'Interest Expense',
	 'interestExpense'),
	('Amortization and depreciation are two methods of calculating the value for business assets over time. Amortization is the practice of spreading an intangible assets cost over that assets useful life. Depreciation is the expensing a fixed asset as it is used to reflect its anticipated deterioration.',
	 'Depreciation and Amortization',
	 'depreciationAndAmortization'),
	('EBITDA, or earnings before interest, taxes, depreciation, and amortization, is an alternate measure of profitability to net income. By stripping out the non-cash depreciation and amortization expense as well as taxes and debt costs dependent on the capital structure, EBITDA attempts to represent cash profit generated by the company’s operations.',
	 'EBITDA',
	 'ebitda'),
	('The EBITDA-to-sales ratio (EBITDA margin) shows how much cash a company generates for each dollar of sales revenue, before accounting for interest, taxes, and amortization & depreciation.',
	 'EBITDA Ratio',
	 'ebitdaratio'),
	('operating income is an indicator that calculates the companys profit after paying the operating expenses.',
	 'Operating Income',
	 'operatingIncome'),
	('Operating profit ratio is a metric that is obtained by dividing the operating income of a business by its net sales. It is a ratio that depicts how much profit a business is making for each dollar worth of sales it is making. Operating profit ratio does not account for tax or interest in the numbers it deals with.',
	 'Operating Income Ratio',
	 'operatingIncomeRatio'),
	('',
	 'Total Other Income Expenses Net',
	 'totalOtherIncomeExpensesNet'),
	('Pretax income is calculated by subtracting a companys operating expenses from its revenue. For example, if a company has $10 million in revenue and its operating expenses are $8 million, it has $2 million in income before taxes.',
	 'Income Before Tax',
	 'incomeBeforeTax'),
	('Earnings before tax (EBT) is a measure of financial performance. It reveals a companys earnings before taxes are deducted, is calculated by subtracting all expenses excluding taxes from revenue, and appears as a line item in the income statement.',
	 'Income Before Tax Ratio',
	 'incomeBeforeTaxRatio'),
	('Tax expenses are the total amount of taxes owed by an individual, corporation, or other entity to a taxing authority. Income tax expense is arrived at by multiplying taxable income by the effective tax rate. Other taxes may be levied against an assets value, such as property or estate taxes.',
	 'Income Tax Expense',
	 'incomeTaxExpense'),
	('Net income (NI), also called net earnings, is calculated as sales minus cost of goods sold, selling, general and administrative expenses, operating expenses, depreciation, interest, taxes, and other expenses. It is a useful number for investors to assess how much revenue exceeds the expenses of an organization. ',
	 'Net Income',
	 'netIncome'),
	('The Net Income Ratio measures how effective your organization is at generating profit on each dollar of earned premium. This KPI is used to measure the profitability of your organization and is primarily used for internal comparison.',
	 'Net Income Ratio',
	 'netIncomeRatio'),
	('Earnings per share (EPS) is a companys net profit divided by the number of common shares it has outstanding. EPS indicates how much money a company makes for each share of its stock and is a widely used metric for estimating corporate value.',
	 'Earnings Per Share',
	 'eps'),
	('Diluted earnings per share (diluted EPS) calculates a companys earnings per share if all convertible securities were converted. Dilutive securities arent common stock, but instead securities that can be converted to common stock.',
	 'Earnings Per Share Diluted',
	 'epsdiluted'),
	('To calculate the weighted average of outstanding shares, take the number of outstanding shares and multiply the portion of the reporting period those shares covered; do this for each portion and then add the totals together.',
	 'Weighted Average Shares Outstanding',
	 'weightedAverageShsOut'),
	('To calculate the weighted average of outstanding shares, take the number of outstanding shares and multiply the portion of the reporting period those shares covered; do this for each portion and then add the totals together',
	 'Weighte Average Shares Outstanding Diluted',
	 'weightedAverageShsOutDil');

INSERT INTO PUBLIC."Financial_Statement_type"(name_financial) 
VALUES ('Income_Statement_Standardized'),
	   ('Balance_Sheet_Standardized'),
	   ('Cash_Flow_Standardized');

INSERT INTO PUBLIC."Financial_Statement_Indicator_sequence"(id_financial_statement_type,id_financial_indicator,sequencia)
VALUES (1,1,1),
	   (1,2,2),
	   (1,3,3),
	   (1,5,4),
	   (1,6,5),
	   (1,7,6),
	   (1,8,7),
	   (1,10,8),
	   (1,17,9),
	   (1,14,10),
	   (1,9,11),
	   (1,12,12),
	   (1,13,13),
	   (1,20,14),
	   (1,22,15),
	   (1,23,16),
	   (1,25,17),
	   (1,26,18),
	   (1,27,19),
	   (1,28,20),
	   (1,11,21),
	   (1,19,22),
	   (1,15,23),
	   (1,4,24),
	   (1,18,25),
	   (1,16,26),
	   (1,21,27),
	   (1,24,28);